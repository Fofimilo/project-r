<!DOCTYPE html>
<!-- saved from url=(0088)file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Sofia Milone">

<title>Time Usage in Europe</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="./Time Usage in Europe_files/clipboard.min.js.download"></script>
<script src="./Time Usage in Europe_files/quarto.js.download"></script>
<script src="./Time Usage in Europe_files/popper.min.js.download"></script>
<script src="./Time Usage in Europe_files/tippy.umd.min.js.download"></script>
<script src="./Time Usage in Europe_files/anchor.min.js.download"></script>
<link href="./Time Usage in Europe_files/tippy.css" rel="stylesheet">
<link href="./Time Usage in Europe_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./Time Usage in Europe_files/bootstrap.min.js.download"></script>
<link href="./Time Usage in Europe_files/bootstrap-icons.css" rel="stylesheet">
<link href="./Time Usage in Europe_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Time Usage in Europe</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Sofia Milone </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="time-usage-in-europe" class="level1">
<h1>TIME USAGE IN EUROPE</h1>
<p>Time is the most valuable and precious resource we have. But what people do with it? This is what we are trying to understand with the following analysis. The data used was provided by EUROSTAT. They are conducting national surveys (HETUS, Harmonised European time use surveys) in EU countries to understand how people spent their time. So far, there are only 2 rounds of survey. The first one called HETUS 2000, in which participated 15 countries, and the second one (HETUS 2010) , where the participating countries were 18.</p>
<p>To know about the investigations: <a href="https://ec.europa.eu/eurostat/cache/metadata/en/tus_esms.htm">Time use survey (tus) (europa.eu)</a></p>
<p>To get the data analysed in this notebook: <a href="https://ec.europa.eu/eurostat/databrowser/view/tus_00age__custom_9558191/default/table?lang=en&amp;page=time:2000">Statistics | Eurostat (europa.eu)</a></p>
<section id="the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="the-dataset">The Dataset<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#the-dataset" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>In the initial dataset we can find 7 variables:</p>
<ul>
<li><p>Frequency - Character</p></li>
<li><p>Sex - categorical with 3 categories: Female (F), Male (M) and Total (T)</p></li>
<li><p>Age - ordinal with different classes</p></li>
<li><p>Activities - There were selected 56 activities in total, divided in 8 macroareas :</p>
<ul>
<li><p>Personal care</p></li>
<li><p>Eat</p></li>
<li><p>Sleep</p></li>
<li><p>Work</p></li>
<li><p>Study</p></li>
<li><p>Household and family care</p></li>
<li><p>Leisure, social time</p></li>
<li><p>Unspecified Use of time</p></li>
</ul></li>
<li><p>Country</p></li>
<li><p>The time spent on the activity</p></li>
<li><p>The partecipation time= <em>“mean time spent in the activities by those individuals who took part in the activity”</em> (EUROSTAT)</p></li>
<li><p>Participation rate:= <em>“the proportion of the individuals that spent some time doing the activities”</em> (EUROSTAT)</p></li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
Linking to GEOS 3.11.2, GDAL 3.7.2, PROJ 9.3.0; sf_use_s2() is TRUE


Caricamento pacchetto: 'hms'


Il seguente oggetto è mascherato da 'package:lubridate':

    hms</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 78543 Columns: 3
── Column specification ────────────────────────────────────────────────────────
Delimiter: "\t"
chr (3): freq,unit,sex,age,acl00,geo\TIME_PERIOD, 2000, 2010

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "freq,unit,sex,age,acl00,geo\\TIME_PERIOD"
[2] "2000"                                    
[3] "2010"                                    </code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  sex   age   activities state  year PTP_TIME              TIME_SP              
  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt; &lt;dbl&gt; &lt;Duration&gt;            &lt;Duration&gt;           
1 F     TOTAL AC0        AT     2010 39240s (~10.9 hours)  39240s (~10.9 hours) 
2 F     TOTAL AC0        BE     2000 40260s (~11.18 hours) 40260s (~11.18 hours)
3 F     TOTAL AC0        BE     2010 41100s (~11.42 hours) 41100s (~11.42 hours)
4 F     TOTAL AC0        BG     2000 41880s (~11.63 hours) 41880s (~11.63 hours)
5 F     TOTAL AC0        DE     2000 39480s (~10.97 hours) 39480s (~10.97 hours)
6 F     TOTAL AC0        DE     2010 40320s (~11.2 hours)  40320s (~11.2 hours) 
# ℹ 2 more variables: activities_labeled &lt;fct&gt;, state_labeled &lt;fct&gt;</code></pre>
</div>
</div>
</section>
<section id="how-people-spend-their-time" class="level2">
<h2 class="anchored" data-anchor-id="how-people-spend-their-time">HOW PEOPLE SPEND THEIR TIME?<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#how-people-spend-their-time" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>In the surveys, the activities were divided in 8 macroareas: personal care, eat, sleep, work, study, household and family care, leisure, social time, unspecified use of time. In the plot below we can see that the majority of the time is spent on personal care in all european countries. The most vain state is Lithuania(EL), which is also the country with higher sleeping time. On the contrary, in Norway people sleep less.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="./Time Usage in Europe_files/unnamed-chunk-4-1.png" class="img-fluid" width="1920"></p>
</div>
</div>
<p>Next, we are going to see what are the activities classified as leisure and social life. From the plot, we can see that the leisure activity with the higher time spent is watching television and\or videos. We find resting and visiting\feasts respectively in 3rd and 4th place.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-1" aria-hidden="true" tabindex="-1"></a>leisureactivities<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'AC41'</span>,<span class="st">'AC42'</span>,<span class="st">'AC43'</span>,<span class="st">'AC51A'</span>,<span class="st">'AC51B'</span>,<span class="st">'AC52'</span>,<span class="st">'AC53'</span>,<span class="st">'AC611'</span>,<span class="st">'AC6A'</span>,<span class="st">'AC733'</span>,<span class="st">'AC7A'</span>,<span class="st">'AC7B'</span>,<span class="st">'AC812'</span>,<span class="st">'AC811'</span>,<span class="st">'AC82'</span>,<span class="st">'AC83'</span>,<span class="st">'AC4-8NSP'</span>)</span>
<span id="cb5-2"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-3" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span> timeusage <span class="sc">%&gt;%</span> <span class="fu">filter</span>(age<span class="sc">==</span><span class="st">"TOTAL"</span>, sex<span class="sc">==</span><span class="st">"T"</span>, year<span class="sc">==</span><span class="dv">2010</span>, activities <span class="sc">%in%</span> leisureactivities) <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span><span class="fu">reorder</span>(activities_labeled,TIME_SP), <span class="at">y=</span>TIME_SP)) </span>
<span id="cb5-4"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-4" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">'#44AA99'</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Different Types of Leisure Activities"</span>, <span class="at">x=</span><span class="st">"Leisure Activities"</span>, <span class="at">y=</span><span class="st">'Time spent on the activity'</span>, <span class="at">caption =</span> <span class="st">"Source: EUROSTAT, Year:2010"</span>)<span class="sc">+</span> <span class="fu">scale_y_time</span>() <span class="sc">+</span> <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">theme</span>(</span>
<span id="cb5-5"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot.title =</span> <span class="fu">element_text</span>( <span class="at">vjust =</span> <span class="fl">2.0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">'#333333'</span>,</span>
<span id="cb5-6"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">size =</span> <span class="fu">rel</span>(<span class="dv">3</span>)),</span>
<span id="cb5-7"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.7</span>)),</span>
<span id="cb5-8"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t=</span><span class="dv">15</span>)),</span>
<span id="cb5-9"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.2</span>)),</span>
<span id="cb5-10"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">vjust=</span><span class="dv">3</span>)</span>
<span id="cb5-11"><a href="file:///C:/Users/lella/Downloads/Project_Sofia_Milone/Data_Vis/Project_Sofia_Milone.html#cb5-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./Time Usage in Europe_files/unnamed-chunk-5-1.png" class="img-fluid" width="1248"></p>
</div>
</div>
<p>In the plot below, I tried to see if there was a correlation between Leisure time and working time. We can see actually that there’s a negative correlation. This means that we more time is spent on working, the less is spent in leisure activities. Indeed, the Pearson’s correlation coefficient is negative (-0,47). But from the plot we can also see that the country that works the most is Romania, and on the other hand people from Finland spend more than 6 hours in leisure activities. They had the highest amount of leisure time in 2010.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  state            TIME_SP.x            TIME_SP.y
1    AT  18360s (~5.1 hours) 30660s (~8.52 hours)
2    BE 20460s (~5.68 hours)  30960s (~8.6 hours)
3    DE 21060s (~5.85 hours) 30360s (~8.43 hours)
4    EE 19380s (~5.38 hours) 31800s (~8.83 hours)
5    EL 20640s (~5.73 hours)  30960s (~8.6 hours)
6    ES 18660s (~5.18 hours) 31080s (~8.63 hours)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Time Usage in Europe_files/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now, I wanted to see if there was also a similar linear correlation between studying time and leisure. In this case, there’s almost no linear correlation as it is also confirmed by the Pearson’s correlation coefficient. Indeed, when this coefficient is near 0, it means that there’s no linear correlation.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Time Usage in Europe_files/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the plot above we can see the Belgium is the country where people study the most. This is confirmed also by the map below. In this map, it’s shown the time dedicated to study activities in the countries that participated in the 2010 HETUS. Humorously , a neighbor of Belgium has the lower time spent in studying. This country is Germany, where people spent less than 20 minutes per day to study activities.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: attribute variables are assumed to be spatially constant throughout
all geometries</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Time Usage in Europe_files/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the following plot, I wanted to investigate why Belgium had more studying time than the others. Belgium is highlighted with the color red. As we can see, Belgium people spend a lot of time in school or university and in doing homework.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="./Time Usage in Europe_files/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the next plot, I wanted to see the difference time spent on each main activities between females and males. There are no big differences except for time dedicated to work and household and family care.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="./Time Usage in Europe_files/unnamed-chunk-10-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>In the plots below, we can see the difference in time spent in household and family care. Female tend to spend more time than males. We can see this phenomenon both in the year 2000 and 2010.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="./Time Usage in Europe_files/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>